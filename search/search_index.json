{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"antigen-prime","text":"<p>antigen-prime is an epidemiological simulation framework written in Java that models virus evolution and population dynamics. It simulates SIR (Susceptible-Infected-Recovered) models with genetic/phenotypic evolution of pathogens.</p>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code># Clone and build\ngit clone https://github.com/matsengrp/antigen-prime.git\ncd antigen-prime\nmvn clean package\n\n# Run simulation\njava -jar target/antigen-prime.jar -XX:+UseSerialGC -Xmx8G\n</code></pre>"},{"location":"#documentation","title":"Documentation","text":"<ul> <li>Requirements - System requirements and dependencies</li> <li>Compilation - Build instructions</li> <li>Mutation Model - K80 mutation and antigenic evolution</li> <li>Immunity Centroids - Host population immunity sampling</li> <li>Parameters Reference - Configuration options</li> <li>Output Analysis - Understanding simulation output</li> </ul>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>SIR Epidemiology: Full susceptible-infected-recovered dynamics with demographics</li> <li>Metapopulation Structure: Multiple demes with migration and seasonal forcing</li> <li>Phenotype Evolution: Multiple evolution models (geometric, sequence-based, DMS-informed)</li> <li>Phylogenetic Tracking: Complete genealogy of virus lineages</li> <li>Flexible Sampling: Configurable sampling schemes for downstream analysis</li> </ul>"},{"location":"#building-documentation","title":"Building Documentation","text":"<pre><code>pip install -r docs/requirements.txt\nmkdocs serve  # preview at http://127.0.0.1:8000\nmkdocs build  # build static site to site/\n</code></pre>"},{"location":"installation/compilation/","title":"Compilation Guide","text":""},{"location":"installation/compilation/#maven-compilation-recommended","title":"Maven Compilation (Recommended)","text":"<p>Maven is the recommended build method as it automatically handles all dependencies and provides a standardized build process.</p>"},{"location":"installation/compilation/#basic-compilation","title":"Basic Compilation","text":"<pre><code># Clean and compile\nmvn clean compile\n\n# Run tests\nmvn test\n\n# Create JAR file with all dependencies\nmvn package\n</code></pre>"},{"location":"installation/compilation/#output-files","title":"Output Files","text":"<p>Maven creates two JAR files in the <code>target/</code> directory:</p> <ul> <li><code>target/antigen-prime.jar</code> - Complete executable with all dependencies (recommended)</li> <li><code>target/antigen-prime-no-dependencies.jar</code> - Classes only, requires classpath setup</li> </ul>"},{"location":"installation/compilation/#running-the-application","title":"Running the Application","text":""},{"location":"installation/compilation/#using-the-complete-jar-recommended","title":"Using the Complete JAR (Recommended)","text":"<pre><code>java -jar target/antigen-prime.jar -XX:+UseSerialGC -Xmx8G\n</code></pre>"},{"location":"installation/compilation/#using-maven-exec-plugin-development","title":"Using Maven Exec Plugin (Development)","text":"<pre><code>mvn compile exec:java -Dexec.mainClass=\"org.antigen.Antigen\" -Dexec.args=\"-XX:+UseSerialGC -Xmx8G\"\n</code></pre>"},{"location":"installation/compilation/#common-maven-commands","title":"Common Maven Commands","text":"<pre><code># Clean build artifacts\nmvn clean\n\n# Compile without running tests\nmvn compile -DskipTests\n\n# Run only specific test\nmvn test -Dtest=TestGeometricSeqPhenotype\n\n# Generate project documentation\nmvn javadoc:javadoc\n\n# Check for dependency updates\nmvn versions:display-dependency-updates\n</code></pre>"},{"location":"installation/compilation/#manual-compilation-alternative","title":"Manual Compilation (Alternative)","text":"<p>If Maven is not available, you can compile manually. However, this requires managing dependencies manually and is not recommended for most users.</p>"},{"location":"installation/compilation/#prerequisites-for-manual-compilation","title":"Prerequisites for Manual Compilation","text":"<p>You'll need to have the following JAR files available (typically in <code>~/.m2/repository/</code> after running Maven once):</p> <ul> <li><code>snakeyaml-2.0.jar</code> - YAML parsing</li> <li><code>colt-1.2.0.jar</code> - Scientific computing library</li> <li><code>classmexer.jar</code> - Memory profiling (optional)</li> </ul>"},{"location":"installation/compilation/#manual-compilation-commands","title":"Manual Compilation Commands","text":""},{"location":"installation/compilation/#basic-compilation_1","title":"Basic Compilation","text":"<pre><code>javac -cp \"src/main/java:src/main/resources\" \\\n  src/main/java/org/antigen/*.java \\\n  src/main/java/org/antigen/*/*.java\n</code></pre>"},{"location":"installation/compilation/#with-explicit-dependencies","title":"With Explicit Dependencies","text":"<pre><code>javac -classpath \"src/main/java:src/main/resources:~/.m2/repository/colt/colt/1.2.0/colt-1.2.0.jar:~/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar\" \\\n  src/main/java/org/antigen/*.java \\\n  src/main/java/org/antigen/*/*.java\n</code></pre>"},{"location":"installation/compilation/#running-manually-compiled-code","title":"Running Manually Compiled Code","text":"<pre><code>java -cp \"src/main/java:src/main/resources:~/.m2/repository/colt/colt/1.2.0/colt-1.2.0.jar:~/.m2/repository/org/yaml/snakeyaml/2.0/snakeyaml-2.0.jar\" \\\n  -XX:+UseSerialGC -Xmx8G \\\n  org.antigen.Antigen\n</code></pre>"},{"location":"installation/compilation/#jvm-options-explained","title":"JVM Options Explained","text":""},{"location":"installation/compilation/#memory-management","title":"Memory Management","text":"<ul> <li><code>-Xmx8G</code>: Sets maximum heap size to 8GB (adjust based on your simulation size)</li> <li><code>-XX:+UseSerialGC</code>: Uses serial garbage collector (more efficient for antigen-prime's memory patterns)</li> </ul>"},{"location":"installation/compilation/#performance-tuning","title":"Performance Tuning","text":"<pre><code># For large simulations\njava -jar target/antigen-prime.jar -XX:+UseSerialGC -Xmx16G -server\n\n# For memory-constrained systems\njava -jar target/antigen-prime.jar -XX:+UseSerialGC -Xmx2G -Xms1G\n</code></pre>"},{"location":"installation/compilation/#memory-profiling-optional","title":"Memory Profiling (Optional)","text":"<p>If you have <code>classmexer.jar</code> available: <pre><code>java -javaagent:classmexer.jar -jar target/antigen-prime.jar -XX:+UseSerialGC -Xmx8G\n</code></pre></p>"},{"location":"installation/compilation/#troubleshooting-compilation","title":"Troubleshooting Compilation","text":""},{"location":"installation/compilation/#common-issues","title":"Common Issues","text":""},{"location":"installation/compilation/#java_home-not-set","title":"\"JAVA_HOME not set\"","text":"<pre><code># macOS\nexport JAVA_HOME=$(/usr/libexec/java_home)\n\n# Linux\nexport JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64\n\n# Make permanent by adding to ~/.bashrc or ~/.bash_profile\necho 'export JAVA_HOME=$(/usr/libexec/java_home)' &gt;&gt; ~/.bash_profile\n</code></pre>"},{"location":"installation/compilation/#maven-command-not-found","title":"\"Maven command not found\"","text":"<p>Install Maven using your system's package manager: <pre><code># macOS\nbrew install maven\n\n# Ubuntu/Debian\nsudo apt install maven\n\n# CentOS/RHEL\nsudo yum install maven\n</code></pre></p>"},{"location":"installation/compilation/#out-of-memory-during-compilation","title":"\"Out of memory\" during compilation","text":"<p>Increase Maven's memory: <pre><code>export MAVEN_OPTS=\"-Xmx2G\"\nmvn clean package\n</code></pre></p>"},{"location":"installation/compilation/#dependency-download-failures","title":"Dependency download failures","text":"<p>Clear Maven cache and retry: <pre><code>rm -rf ~/.m2/repository\nmvn clean package\n</code></pre></p>"},{"location":"installation/compilation/#build-verification","title":"Build Verification","text":"<p>After successful compilation, verify the build:</p> <pre><code># Check JAR file exists\nls -la target/antigen-prime.jar\n\n# Quick test run (should show help/parameter info)\njava -jar target/antigen-prime.jar --help\n\n# Memory test\njava -XX:+UseSerialGC -Xmx1G -jar target/antigen-prime.jar\n</code></pre> <p>A successful build will create a functional JAR file that can run simulations according to the configured parameters.</p>"},{"location":"installation/requirements/","title":"System Requirements","text":""},{"location":"installation/requirements/#java-requirements","title":"Java Requirements","text":"<p>antigen-prime requires Java 16 or higher to compile and run. This is due to specific language features and performance optimizations used in the codebase.</p>"},{"location":"installation/requirements/#checking-your-java-version","title":"Checking Your Java Version","text":"<pre><code>java -version\n</code></pre> <p>You should see something like: <pre><code>openjdk version \"16.0.1\" 2021-04-20\n</code></pre></p>"},{"location":"installation/requirements/#installing-java","title":"Installing Java","text":""},{"location":"installation/requirements/#macos","title":"macOS","text":"<pre><code># Using Homebrew\nbrew install openjdk@17\n\n# Using SDKMAN\nsdk install java 17.0.1-open\n</code></pre>"},{"location":"installation/requirements/#linux-ubuntudebian","title":"Linux (Ubuntu/Debian)","text":"<pre><code>sudo apt update\nsudo apt install openjdk-17-jdk\n</code></pre>"},{"location":"installation/requirements/#linux-centosrhel","title":"Linux (CentOS/RHEL)","text":"<pre><code>sudo yum install java-17-openjdk-devel\n</code></pre>"},{"location":"installation/requirements/#fred-hutch-cluster-specific-environment-skip-if-not-applicable","title":"Fred Hutch Cluster (Specific Environment - Skip if Not Applicable)","text":"<p><pre><code>source /app/lmod/lmod/init/profile\nml Java/11\n</code></pre> Note: This is only for users working on the Fred Hutch computational cluster.  Most users can skip this section and install Java through the standard methods above. Java 11 is the minimum for this specific cluster, but Java 16+ is still recommended for optimal performance.</p>"},{"location":"installation/requirements/#build-tools","title":"Build Tools","text":""},{"location":"installation/requirements/#maven-recommended","title":"Maven (Recommended)","text":"<p>Maven handles all dependencies automatically and is the preferred build method.</p>"},{"location":"installation/requirements/#installation","title":"Installation","text":"<ul> <li>macOS: <code>brew install maven</code></li> <li>Linux: <code>sudo apt install maven</code> (Ubuntu) or <code>sudo yum install maven</code> (CentOS)</li> <li>Windows: Download from Apache Maven</li> </ul>"},{"location":"installation/requirements/#alternative-manual-compilation","title":"Alternative: Manual Compilation","text":"<p>If Maven is unavailable, manual compilation is supported but requires managing dependencies manually.</p>"},{"location":"installation/requirements/#memory-requirements","title":"Memory Requirements","text":""},{"location":"installation/requirements/#minimum-system-memory","title":"Minimum System Memory","text":"<ul> <li>Small simulations (&lt; 100,000 hosts): 2GB RAM</li> <li>Medium simulations (100,000 - 1M hosts): 8GB RAM  </li> <li>Large simulations (&gt; 1M hosts): 16GB+ RAM</li> </ul>"},{"location":"installation/requirements/#jvm-memory-allocation","title":"JVM Memory Allocation","text":"<p>The <code>-Xmx</code> flag controls Java memory allocation: <pre><code># Small simulation\njava -jar antigen-prime.jar -Xmx2G\n\n# Large simulation  \njava -jar antigen-prime.jar -Xmx16G\n</code></pre></p>"},{"location":"installation/requirements/#memory-usage-calculation","title":"Memory Usage Calculation","text":"<p>Each host requires approximately: - 40 bytes base memory - 8 bytes per immune history entry</p> <p>With default parameters (15% yearly attack rate, 30-year lifespan): - Average immune history: 4.5 entries per host - Memory per host: 40 + (4.5 \u00d7 8) = 76 bytes - For 7.5M hosts: ~570MB</p> <p>Additional memory is needed for virus genealogy tracking, which grows throughout the simulation.</p>"},{"location":"installation/requirements/#storage-requirements","title":"Storage Requirements","text":""},{"location":"installation/requirements/#input-files","title":"Input Files","text":"<ul> <li>Minimal: Configuration files only (~1KB)</li> <li>With sequence data: Up to 100MB for large genomes and DMS data</li> </ul>"},{"location":"installation/requirements/#output-files","title":"Output Files","text":"<ul> <li>Small simulations: 10-100MB</li> <li>Medium simulations: 100MB-1GB</li> <li>Large simulations: 1GB-10GB+</li> </ul> <p>Output size depends on: - Simulation duration - Sampling frequency - Number of demes - Whether detailed output is enabled</p>"},{"location":"installation/requirements/#performance-considerations","title":"Performance Considerations","text":""},{"location":"installation/requirements/#cpu-requirements","title":"CPU Requirements","text":"<ul> <li>Minimum: Single-core 2GHz processor</li> <li>Recommended: Multi-core processor (antigen-prime can utilize multiple cores for certain operations)</li> </ul>"},{"location":"installation/requirements/#garbage-collection","title":"Garbage Collection","text":"<p>For best performance, use the serial garbage collector: <pre><code>java -jar antigen-prime.jar -XX:+UseSerialGC -Xmx8G\n</code></pre></p> <p>This is much more efficient for antigen-prime's memory allocation patterns than the default parallel collector.</p>"},{"location":"installation/requirements/#development-tools-optional","title":"Development Tools (Optional)","text":"<p>For developers and contributors: - Git: For version control and contributing - IDE: IntelliJ IDEA, Eclipse, or VS Code with Java support - Testing: JUnit (included in Maven dependencies)</p>"},{"location":"user-guide/immunity-centroids/","title":"Host Immunity Centroids","text":"<p>antigen-prime periodically samples host population immunity and outputs centroids representing the average antigenic position of recent infections. These centroids enable downstream fitness calculations for benchmarking growth-advantage models.</p>"},{"location":"user-guide/immunity-centroids/#overview","title":"Overview","text":"<p>Each host maintains an immune history from previous infections. The immunity centroid captures the average antigenic position of the population's most recent infections, providing a summary of population-level immunity at each time point.</p>"},{"location":"user-guide/immunity-centroids/#enabling-centroid-output","title":"Enabling Centroid Output","text":"Parameter Default Description <code>sampleHostImmunity</code> false Enable periodic immunity sampling <code>printHostImmunityStep</code> 365 Sampling interval in days <code>hostImmunitySamplesPerDeme</code> [10000, 10000, 10000] Hosts sampled per deme"},{"location":"user-guide/immunity-centroids/#output-file-outhistoriescsv","title":"Output File: <code>out.histories.csv</code>","text":"<p>When <code>sampleHostImmunity: true</code>, antigen-prime outputs <code>out.histories.csv</code> with columns:</p> Column Description <code>year</code> Simulation time in years <code>deme</code> Geographic deme name or \"total\" for global <code>ag1</code> Centroid x-coordinate in antigenic space <code>ag2</code> Centroid y-coordinate in antigenic space <code>naive_fraction</code> Fraction of sampled hosts with no immune history <code>experienced_hosts</code> Count of hosts with at least one prior infection <p>Example output: <pre><code>year,deme,ag1,ag2,naive_fraction,experienced_hosts\n0.0000,north,-6.000000,0.000000,0.4981,5019\n0.0000,tropics,-6.000000,0.000000,0.4968,5032\n0.0000,south,-6.000000,0.000000,0.5070,4930\n0.0000,total,-6.000000,0.000000,0.5006,14981\n1.0000,north,-2.537124,-0.014044,0.2117,7883\n</code></pre></p>"},{"location":"user-guide/immunity-centroids/#centroid-calculation","title":"Centroid Calculation","text":"<p>For each deme at each sampling time:</p> <ol> <li>Sample <code>n</code> random hosts from the population</li> <li>For each host with immune history, extract coordinates of most recent infection</li> <li>Compute centroid as average of these coordinates:</li> </ol> \\[\\bar{c}_t = \\frac{1}{n_{exp}} \\sum_{i=1}^{n_{exp}} h_i^{(\\text{recent})}\\] <p>Where: - \\(n_{exp}\\) = number of experienced (non-naive) hosts - \\(h_i^{(\\text{recent})}\\) = antigenic coordinates of host \\(i\\)'s most recent infection</p> <p>The global (\"total\") centroid is computed as a weighted average across demes, weighted by number of experienced hosts.</p>"},{"location":"user-guide/immunity-centroids/#using-centroids-for-fitness-calculation","title":"Using Centroids for Fitness Calculation","text":"<p>Virus fitness can be approximated using distance to the population immunity centroid:</p> \\[\\text{fitness}(v) = \\min(1, ||v - \\bar{c}_t|| \\times \\sigma)\\] <p>Where: - \\(v\\) = virus antigenic coordinates (ag1, ag2) - \\(\\bar{c}_t\\) = population immunity centroid at time \\(t\\) - \\(\\sigma\\) = <code>smithConversion</code> parameter (default 0.1)</p> <p>Viruses antigenically distant from the centroid have higher fitness (higher infection risk), reflecting immune escape.</p>"},{"location":"user-guide/immunity-centroids/#example-configuration","title":"Example Configuration","text":"<pre><code># Sample 10,000 hosts per deme annually\nsampleHostImmunity: true\nprintHostImmunityStep: 365\nhostImmunitySamplesPerDeme: [10000, 10000, 10000]\n\n# Cross-immunity parameters (for fitness calculation)\nsmithConversion: 0.1\nhomologousImmunity: 0.05\n</code></pre>"},{"location":"user-guide/immunity-centroids/#implementation","title":"Implementation","text":"<p>Key source files:</p> <ul> <li><code>src/main/java/org/antigen/core/Simulation.java</code> - <code>printPopulationImmunityCentroids()</code></li> <li><code>src/main/java/org/antigen/host/HostPopulation.java</code> - <code>getPopulationImmunitySummary()</code></li> <li><code>src/main/java/org/antigen/host/Host.java</code> - <code>getImmunityCoordinatesCentroid()</code></li> <li><code>src/main/java/org/antigen/host/ImmunitySummary.java</code> - Data class for centroid results</li> </ul>"},{"location":"user-guide/immunity-centroids/#references","title":"References","text":"<ul> <li>Smith DJ et al. (2004). Mapping the antigenic and genetic evolution of influenza virus. Science.</li> <li>Luksza M, Lassig M. (2014). A predictive fitness model for influenza. Nature.</li> </ul>"},{"location":"user-guide/mutation-model/","title":"Mutation Model","text":"<p>antigen-prime couples genetic sequence evolution with antigenic phenotype changes. Each virus carries both a nucleotide sequence and coordinates in antigenic space. Mutation events simultaneously change the sequence and may move the virus in antigenic space.</p>"},{"location":"user-guide/mutation-model/#k80-nucleotide-mutation","title":"K80 Nucleotide Mutation","text":"<p>Mutations follow the K80 (Kimura 1980) model parameterized by a transition/transversion ratio \\(\\kappa\\).</p> Parameter Default Description <code>transitionTransversionRatio</code> 5.0 Bias toward transitions vs transversions <p>Default \\(\\kappa = 5.0\\) matches empirical observations in influenza (Rabadan et al. 2006, Bloom &amp; Glassman 2009).</p> <p>During mutation:</p> <ol> <li>A nucleotide site is randomly selected</li> <li>A new nucleotide is drawn from the K80 probability distribution</li> <li>If mutation creates a stop codon, reject and try another site</li> </ol>"},{"location":"user-guide/mutation-model/#epitope-vs-non-epitope-sites","title":"Epitope vs Non-Epitope Sites","text":"<p>The initial sequence encodes a protein. Users define a subset of amino-acid sites as \"epitope sites\" (remaining sites are \"non-epitope\").</p> Parameter Default Description <code>epitopeSites</code> \"epitopeSites.txt\" File listing epitope site indices (1-indexed) <p>For influenza HA, we typically use the 49 epitope sites from Luksza &amp; Lassig (2014).</p>"},{"location":"user-guide/mutation-model/#antigenic-space-movement","title":"Antigenic Space Movement","text":"<p>The effect of a mutation depends on whether and how it changes the protein:</p> Mutation Type Antigenic Effect Synonymous No movement Non-synonymous at epitope site Large movement Non-synonymous at non-epitope site Very small movement"},{"location":"user-guide/mutation-model/#step-size-distribution","title":"Step Size Distribution","text":"<p>Movement step sizes are drawn from gamma distributions:</p> Parameter Default Description <code>meanStepEpitope</code> 0.6 Mean step size for epitope mutations (antigenic units) <code>sdStepEpitope</code> 0.3 Standard deviation for epitope mutations <code>meanStep</code> 1e-5 Mean step size for non-epitope mutations <code>sdStep</code> 0.3 Standard deviation for non-epitope mutations <p>Default epitope step size of 0.6 antigenic units produces ~1.6 AU/year antigenic drift matching empirical HI assay data (Smith et al. 2004, Koel et al. 2013).</p>"},{"location":"user-guide/mutation-model/#step-direction","title":"Step Direction","text":"<p>The direction \\(\\theta\\) of movement in antigenic space is uniformly random.</p> Parameter Default Description <code>mut2D</code> false If true, allow full 360\u00b0 arc; if false, 1D movement only"},{"location":"user-guide/mutation-model/#acceptance-rates","title":"Acceptance Rates","text":"<p>Users can apply acceptance/rejection filtering to model selection:</p> Parameter Default Description <code>epitopeAcceptance</code> 1.0 Probability of accepting epitope mutations <code>nonEpitopeAcceptance</code> 1.0 Probability of accepting non-epitope mutations <p>Setting different rates allows modeling differential selection between site types. Note: only applied to non-synonymous mutations.</p>"},{"location":"user-guide/mutation-model/#highlow-epitope-sites","title":"High/Low Epitope Sites","text":"<p>For finer control, epitope sites can be subdivided into \"high\" and \"low\" categories with different step size distributions:</p> Parameter Default Description <code>proportionHighSites</code> 0.2 Fraction of epitope sites designated as \"high\" <code>meanStepEpitopeLow</code> 0.3 Mean step for \"low\" epitope sites <code>meanStepEpitopeHigh</code> 0.3 Mean step for \"high\" epitope sites"},{"location":"user-guide/mutation-model/#predefined-vectors","title":"Predefined Vectors","text":"<p>By default, step sizes and directions are drawn randomly. Alternatively, users can predefine mutation vectors for each site/amino-acid pair:</p> Parameter Default Description <code>predefinedVectors</code> false Use precomputed site-specific mutation effects"},{"location":"user-guide/mutation-model/#implementation","title":"Implementation","text":"<p>The mutation logic is implemented in <code>GeometricSeqPhenotype.mutate()</code>:</p> <pre><code>src/main/java/org/antigen/phenotype/GeometricSeqPhenotype.java\n</code></pre> <p>Key steps:</p> <ol> <li>Select random nucleotide site</li> <li>Draw mutant nucleotide from K80 distribution</li> <li>Reject if creates stop codon</li> <li>Determine if synonymous; if so, return with sequence change only</li> <li>Apply acceptance filter based on site type</li> <li>Update mutation counts (epitope/non-epitope)</li> <li>Calculate antigenic step (predefined or random)</li> <li>Return new phenotype with updated sequence and coordinates</li> </ol>"},{"location":"user-guide/mutation-model/#references","title":"References","text":"<ul> <li>Kimura M. (1980). A simple method for estimating evolutionary rates of base substitutions. J Mol Evol.</li> <li>Smith DJ et al. (2004). Mapping the antigenic and genetic evolution of influenza virus. Science.</li> <li>Luksza M, Lassig M. (2014). A predictive fitness model for influenza. Nature.</li> <li>Koel BF et al. (2013). Substitutions near the receptor binding site determine major antigenic change during influenza virus evolution. Science.</li> </ul>"},{"location":"user-guide/parameters-reference/","title":"Parameters Reference Guide","text":"<p>This guide explains all parameters available in antigen-prime, organized by functional category. Parameters are configured in the <code>src/main/resources/parameters.yml</code> file, which overrides default values defined in the code.</p>"},{"location":"user-guide/parameters-reference/#simulation-control-parameters","title":"Simulation Control Parameters","text":""},{"location":"user-guide/parameters-reference/#basic-simulation-settings","title":"Basic Simulation Settings","text":"Parameter Default Description <code>burnin</code> 0 Days to wait before logging output (allows system to reach equilibrium) <code>endDay</code> 5000 Total number of days to simulate <code>deltaT</code> 0.1 Time step size in days (0.1 = 2.4 hours per step) <code>printStep</code> 10 Output frequency - write to timeseries every N days <code>repeatSim</code> true Whether to repeat simulation until endDay is reached if population dies out <p>Usage Notes: - Use <code>burnin &gt; 0</code> to exclude initial transient dynamics from output - Smaller <code>deltaT</code> gives more accurate results but increases computation time - <code>printStep</code> affects file size - smaller values create larger output files</p>"},{"location":"user-guide/parameters-reference/#output-control","title":"Output Control","text":"Parameter Default Description <code>outPath</code> \"output/\" Directory path for output files <code>outPrefix</code> \"run-\" Prefix for all output filenames <code>reducedOutput</code> false Output only summary and timeseries (minimal files) <code>detailedOutput</code> false Include detailed host and virus files (enables checkpointing) <code>restartFromCheckpoint</code> false Load population state from previous detailed output"},{"location":"user-guide/parameters-reference/#memory-and-performance","title":"Memory and Performance","text":"Parameter Default Description <code>memoryProfiling</code> false Enable memory usage tracking (requires classmexer.jar)"},{"location":"user-guide/parameters-reference/#population-structure-parameters","title":"Population Structure Parameters","text":""},{"location":"user-guide/parameters-reference/#metapopulation-settings","title":"Metapopulation Settings","text":"Parameter Default Description <code>demeCount</code> 3 Number of geographic demes (populations) <code>demeNames</code> [\"north\", \"tropics\", \"south\"] Names for each deme <code>initialNs</code> [1000000, 1000000, 1000000] Initial population size for each deme"},{"location":"user-guide/parameters-reference/#migration-between-demes","title":"Migration Between Demes","text":"Parameter Default Description <code>betweenDemePro</code> 0.0005 Fraction of contacts that occur between demes <p>Example: With <code>betweenDemePro = 0.0005</code>, contacts between demes occur at 0.05% the rate of within-deme contacts.</p>"},{"location":"user-guide/parameters-reference/#host-demographics","title":"Host Demographics","text":""},{"location":"user-guide/parameters-reference/#birth-and-death-rates","title":"Birth and Death Rates","text":"Parameter Default Description <code>birthRate</code> 0.000091 Births per individual per day (\u224830 year lifespan) <code>deathRate</code> 0.000091 Deaths per individual per day (\u224830 year lifespan) <code>swapDemography</code> true Maintain constant population size by balancing births/deaths <p>Lifespan Calculation: <code>1/deathRate</code> days = lifespan. Default 0.000091 = ~30 years.</p>"},{"location":"user-guide/parameters-reference/#epidemiological-parameters","title":"Epidemiological Parameters","text":""},{"location":"user-guide/parameters-reference/#transmission-dynamics","title":"Transmission Dynamics","text":"Parameter Default Description <code>beta</code> 0.36 Contact rate - contacts per individual per day <code>nu</code> 0.2 Recovery rate - recoveries per individual per day <p>Key Relationships: - Infectious period: <code>1/nu</code> days (default: 5 days) - Basic reproduction number (R\u2080): Approximately <code>beta/nu</code> in naive population</p>"},{"location":"user-guide/parameters-reference/#initial-conditions","title":"Initial Conditions","text":"Parameter Default Description <code>initialI</code> 10 Number of initially infected individuals <code>initialDeme</code> 2 Index of deme where infection starts (1-indexed) <code>initialPrR</code> 0.5 Initial proportion of population with immunity"},{"location":"user-guide/parameters-reference/#transcendental-immunity-optional","title":"Transcendental Immunity (Optional)","text":"Parameter Default Description <code>transcendental</code> false Include general recovered class (non-strain-specific immunity) <code>immunityLoss</code> 0.01 Rate of immunity loss (R\u2192S per individual per day) <code>initialPrT</code> 0.1 Initial fraction in general recovered class"},{"location":"user-guide/parameters-reference/#seasonal-transmission","title":"Seasonal Transmission","text":""},{"location":"user-guide/parameters-reference/#seasonal-patterns-by-deme","title":"Seasonal Patterns by Deme","text":"Parameter Default Description <code>demeBaselines</code> [1, 1, 1] Baseline transmission multiplier for each deme <code>demeAmplitudes</code> [0.1, 0, 0.1] Seasonal amplitude for each deme <code>demeOffsets</code> [0, 0, 0.5] Seasonal phase offset (fraction of year) <p>Seasonal Formula: <pre><code>Effective beta = beta \u00d7 [baseline + amplitude \u00d7 cos(2\u03c0 \u00d7 year + 2\u03c0 \u00d7 offset)]\n</code></pre></p> <p>Example: Northern and southern demes have opposite seasonal patterns (offset = 0 vs 0.5).</p>"},{"location":"user-guide/parameters-reference/#virus-evolution-parameters","title":"Virus Evolution Parameters","text":""},{"location":"user-guide/parameters-reference/#phenotype-models","title":"Phenotype Models","text":"Parameter Default Description <code>phenotypeSpace</code> \"geometric\" Phenotype model: \"geometric\", \"geometric3d\", \"geometric10d\", \"geometricSeq\" <code>muPhenotype</code> 0.005 Mutation rate per virus per day"},{"location":"user-guide/parameters-reference/#immune-dynamics","title":"Immune Dynamics","text":"Parameter Default Description <code>waning</code> false Allow immunity to wane over time <code>waningRate</code> 0.01 Rate of losing random immune memory per day"},{"location":"user-guide/parameters-reference/#geometric-phenotype-parameters","title":"Geometric Phenotype Parameters","text":"Parameter Default Description <code>smithConversion</code> 0.1 Multiplier to convert antigenic distance to immunity <code>homologousImmunity</code> 0.05 Immunity against identical virus <code>initialTraitA</code> -6 Initial virus position in dimension 1"},{"location":"user-guide/parameters-reference/#mutation-step-sizes","title":"Mutation Step Sizes","text":"Parameter Default Description <code>meanStep</code> 0.3 Mean mutation step size for non-epitope sites <code>sdStep</code> 0.3 Standard deviation of mutation steps for non-epitope sites <code>mut2D</code> false Allow mutations in full 360\u00b0 arc (vs. 1D only) <code>fixedStep</code> false Use fixed step size (ignore <code>sdStep</code>)"},{"location":"user-guide/parameters-reference/#sequence-based-phenotype-parameters","title":"Sequence-Based Phenotype Parameters","text":""},{"location":"user-guide/parameters-reference/#sequence-configuration","title":"Sequence Configuration","text":"Parameter Default Description <code>startingSequence</code> \"startingSequence.fasta\" FASTA file with initial virus sequence <code>epitopeSites</code> \"epitopeSites.txt\" File listing epitope sites (1-indexed)"},{"location":"user-guide/parameters-reference/#mutation-parameters","title":"Mutation Parameters","text":"Parameter Default Description <code>meanStepEpitope</code> 0.3 Mean mutation step size for epitope sites <code>sdStepEpitope</code> 0.3 Standard deviation for epitope mutations <code>transitionTransversionRatio</code> 5.0 Bias toward transitions vs transversions <code>nonEpitopeAcceptance</code> 1.0 Probability of accepting non-epitope mutations <code>epitopeAcceptance</code> 1.0 Probability of accepting epitope mutations"},{"location":"user-guide/parameters-reference/#advanced-epitope-options","title":"Advanced Epitope Options","text":"Parameter Default Description <code>proportionHighSites</code> 0.2 Fraction of epitope sites with high mutation rates <code>meanStepEpitopeLow</code> 0.3 Mean step size for \"low\" epitope sites <code>sdStepEpitopeLow</code> 0.3 Standard deviation for \"low\" epitope sites <code>meanStepEpitopeHigh</code> 0.3 Mean step size for \"high\" epitope sites <code>sdStepEpitopeHigh</code> 0.3 Standard deviation for \"high\" epitope sites"},{"location":"user-guide/parameters-reference/#dms-integration-optional","title":"DMS Integration (Optional)","text":"Parameter Default Description <code>DMSFile</code> null CSV file with Deep Mutational Scanning fitness data <p>DMS File Format: Must have 21 columns (site number + 20 amino acid preferences) with one row per amino acid site.</p>"},{"location":"user-guide/parameters-reference/#sampling-and-analysis-parameters","title":"Sampling and Analysis Parameters","text":""},{"location":"user-guide/parameters-reference/#virus-sampling","title":"Virus Sampling","text":"Parameter Default Description <code>tipSamplingRate</code> 0.0002 Samples collected per deme per day <code>tipSamplesPerDeme</code> 1000 Maximum samples stored per deme <code>tipSamplingProportional</code> true Sample proportional to prevalence vs. uniform <code>treeProportion</code> 0.1 Fraction of samples used in phylogenetic reconstruction"},{"location":"user-guide/parameters-reference/#diversity-analysis","title":"Diversity Analysis","text":"Parameter Default Description <code>diversitySamplingCount</code> 1000 Samples for calculating diversity statistics <code>netauWindow</code> 100 Window size (days) for Ne\u00d7\u03c4 calculation <code>yearsFromMK</code> 1.0 Time window for Muller-Kreitman analysis <code>pcaSamples</code> false Apply PCA rotation to virus tree"},{"location":"user-guide/parameters-reference/#host-immunity-sampling","title":"Host Immunity Sampling","text":"Parameter Default Description <code>sampleHostImmunity</code> false Record host immunity throughout simulation <code>printHostImmunityStep</code> 100 Frequency of immunity sampling (days) <code>hostImmunitySamplesPerDeme</code> [100, 100, 100] Number of hosts sampled per deme <code>fitnessSampleSize</code> 10000 Hosts sampled for fitness calculations"},{"location":"user-guide/parameters-reference/#memory-analysis","title":"Memory Analysis","text":"Parameter Default Description <code>immunityReconstruction</code> false Output detailed immunity reconstruction"},{"location":"user-guide/parameters-reference/#parameter-configuration-tips","title":"Parameter Configuration Tips","text":""},{"location":"user-guide/parameters-reference/#common-research-scenarios","title":"Common Research Scenarios","text":"<p>Short-term epidemic (seasonal flu): <pre><code>endDay: 365\nburnin: 50\nbeta: 0.4\nnu: 0.2\n</code></pre></p> <p>Long-term evolution study: <pre><code>endDay: 7300  # 20 years\nburnin: 365   # 1 year\nmuPhenotype: 0.01\n</code></pre></p> <p>Large population study: <pre><code>initialNs: [10000000, 5000000, 10000000]  # 25M total\ntipSamplingRate: 0.00001  # Reduce sampling\n</code></pre></p>"},{"location":"user-guide/parameters-reference/#parameter-relationships","title":"Parameter Relationships","text":"<p>Memory Usage: \u221d <code>sum(initialNs)</code> \u00d7 average immune history length Computation Time: \u221d <code>endDay/deltaT</code> \u00d7 <code>sum(initialNs)</code> Output Size: \u221d <code>endDay/printStep</code> \u00d7 sampling rates</p>"},{"location":"user-guide/parameters-reference/#validation-checks","title":"Validation Checks","text":"<p>The model validates parameters on startup: - Sequence length must be multiple of 3 - Epitope sites must be \u2264 sequence length / 3 - DMS data rows must match amino acid sequence length - No stop codons except at sequence end</p>"},{"location":"user-guide/parameters-reference/#performance-recommendations","title":"Performance Recommendations","text":"<p>For faster simulations: - Increase <code>deltaT</code> (0.2-0.5) - Increase <code>printStep</code>  - Reduce sampling rates - Use smaller populations</p> <p>For higher accuracy: - Decrease <code>deltaT</code> (0.05-0.1) - Increase <code>diversitySamplingCount</code> - Use longer <code>burnin</code> periods</p>"}]}